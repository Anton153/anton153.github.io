<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anton Shoham — Engineering & Notes</title>
  <meta name="description" content="A minimal personal website for an engineering portfolio, blog posts, book reviews, and travel photos." />
  <meta name="theme-color" content="#ffffff" />
  <!-- Favicons (inline SVG, adapts to light/dark) -->
  <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='12' ry='12' fill='%23ffffff'/><path d='M8 40 C 16 24 24 56 32 40 S 48 24 56 40' fill='none' stroke='%23111827' stroke-width='4' stroke-linecap='round'/></svg>">
  <link rel="icon" media="(prefers-color-scheme: dark)" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='12' ry='12' fill='%230a0a0a'/><path d='M8 40 C 16 24 24 56 32 40 S 48 24 56 40' fill='none' stroke='%23ffffff' stroke-width='4' stroke-linecap='round'/></svg>">
  <style>
    /* ===== Minimal, uncluttered design ===== */
    :root {
      --bg: #ffffff;
      --text: #0a0a0a;
      --muted: #6b7280; /* cool gray */
      --card: #f7f7f7;
      --line: #e5e7eb;
      --accent: #111827; /* near-black */
      --radius: 14px;
      --maxw: 1000px;
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; background: var(--bg); color: var(--text); font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Inter, sans-serif; }
    a { color: inherit; text-decoration: none; }
    img { display: block; max-width: 100%; height: auto; }

    /* Header */
    .site-header { position: sticky; top: 0; backdrop-filter: saturate(180%) blur(8px); background: rgba(255,255,255,0.85); border-bottom: 1px solid var(--line); }
    .nav { max-width: var(--maxw); margin: 0 auto; display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; }
    .brand { font-weight: 700; letter-spacing: 0.2px; }
    .links { display: flex; gap: 18px; }
    .links a { color: var(--muted); font-weight: 500; }
    .links a:hover, .links a:focus { color: var(--text); }

    /* Layout */
    main { max-width: var(--maxw); margin: 0 auto; padding: 28px 16px 64px; }
    section { padding: 40px 0 20px; border-bottom: 1px solid var(--line); }
    section:last-of-type { border-bottom: 0; }
    h1, h2 { line-height: 1.2; margin: 0 0 8px; }
    h1 { font-size: clamp(28px, 3vw, 36px); }
    h2 { font-size: clamp(22px, 2.4vw, 28px); margin-top: 8px; }
    p.lead { color: var(--muted); margin: 6px 0 0; }

    /* Cards & grids */
    .grid { display: grid; gap: 16px; }
    .grid.cards { grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
    .card { border: 1px solid var(--line); background: var(--card); border-radius: var(--radius); padding: 16px; display: flex; flex-direction: column; gap: 8px; }
    .card h3 { margin: 0; font-size: 18px; }
    .meta { color: var(--muted); font-size: 14px; }
    .tags { display: flex; flex-wrap: wrap; gap: 6px; }
    .tag { font-size: 12px; padding: 2px 8px; border: 1px solid var(--line); border-radius: 999px; color: #374151; background: #fff; }
    .row { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    .btn { display: inline-block; font-size: 14px; border: 1px solid var(--line); padding: 8px 10px; border-radius: 10px; background: #fff; }
    .btn:hover { border-color: #cfd2d7; }

    /* Full-width rows (projects, blog, trips) */
    .project-list, .entry-list, .trip-list { display: grid; gap: 28px; }
    .project, .entry, .trip { display: grid; grid-template-columns: 320px 1fr; gap: 18px; align-items: start; }
    .project + .project, .entry + .entry, .trip + .trip { border-top: 1px solid var(--line); padding-top: 24px; }
    .project img, .entry img, .trip img { width: 100%; height: auto; border-radius: 12px; border: 1px solid var(--line); background: #fff; }
    .project h3, .entry h3, .trip h3 { margin: 0 0 6px; font-size: 20px; }
    .project .meta, .entry .meta, .trip .meta { color: var(--muted); }
    .project .actions, .entry .actions, .trip .actions { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 8px; }
    .project .more, .entry .more, .trip .more { display: none; margin-top: 8px; }
    .project.expanded .more, .entry.expanded .more, .trip.expanded .more { display: block; }
    @media (max-width: 720px) {
      .project, .entry, .trip { grid-template-columns: 1fr; }
    }

    /* Cards may also collapse sections (for books) */
    .card .more { display: none; margin-top: 8px; }
    .card.expanded .more { display: block; }

    /* Photos grid */
    .photos { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }
    .photo { border-radius: 12px; overflow: hidden; position: relative; cursor: zoom-in; background: #fafafa; border: 1px solid var(--line); }

    /* Project gallery (thumbs with captions) */
    .gallery .shot { border-radius: 12px; overflow: hidden; border: 1px solid var(--line); background: #fafafa; cursor: zoom-in; }
    .gallery .shot img { width: 100%; height: auto; display: block; }
    .gallery .shot figcaption { font-size: 12px; color: var(--muted); padding: 6px 8px; border-top: 1px solid var(--line); }

    /* Footer */
    footer { max-width: var(--maxw); margin: 0 auto; padding: 28px 16px 60px; color: var(--muted); }

    /* Modal */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 50; }
    .modal { width: min(860px, 94vw); max-height: 88vh; background: #fff; border-radius: 16px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.15); display: grid; grid-template-rows: auto 1fr; }
    .modal header { display: flex; align-items: center; justify-content: space-between; padding: 12px 14px; border-bottom: 1px solid var(--line); }
    .modal header h3 { margin: 0; font-size: 18px; }
    .modal .content { padding: 16px; overflow: auto; }
    .modal .close { border: 1px solid var(--line); background: #fff; padding: 6px 10px; border-radius: 8px; cursor: pointer; }

/* Lightbox image */
    .lightbox img { width: 100%; height: auto; }
    .lightbox .content { padding: 0; background: #000; }
    .modal.lightbox header { display: none; }
    .lightbox button { background: #111; color: #fff; border-color: rgba(255,255,255,0.2); }
    .modal.lightbox .content { padding: 0; background: #000; }
    .modal.lightbox img { width: 100%; height: auto; display: block; }
    .lightbox-fig { margin: 0; }
    .lightbox-fig figcaption { color: #fff; background: #000; padding: 10px 12px; font-size: 14px; border-top: 1px solid rgba(255,255,255,0.15); }


    /* Small helpers */
    .spacer { height: 8px; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
  </style>
</head>
<body>
  <header class="site-header" role="banner">
    <nav class="nav" aria-label="Primary">
      <div class="brand" id="brand">Anton Shoham</div>
      <div class="links">
        <a href="#about">About</a>
        <a href="#portfolio">Portfolio</a>
        <a href="#blog">Blog</a>
        <a href="#books">Books</a>
        <a href="#photos">Travel</a>
        <a id="contact-link" href="mailto:you@example.com">Contact</a>
      </div>
    </nav>
  </header>

  <main>
    <section id="intro" aria-labelledby="intro-title">
      <h1 id="intro-title">Anton's Blog/Portfolio</h1>
      <p class="lead">The purpose of this webpage is to share some of my technical experiences, opinions, book reviews and travel memories.</p>
    </section>

    <section id="about" aria-labelledby="about-title">
      <h2 id="about-title">About</h2>
      <p class="lead">Hi, I'm Anton Shoham — an Engineering Physics student at UBC</p>
      <div class="spacer"></div>
      <p>remember to add text here</p>
      <div class="row" style="margin-top:12px;">
        <a id="resume-btn" class="btn" href="Anton_Shoham_Resume.pdf" target="_blank" rel="noopener">Open resume</a>
        <a id="email-btn" class="btn" href="mailto:you@example.com">Email me</a>
      </div>
    </section>

    <section id="portfolio" aria-labelledby="portfolio-title">
      <h2 id="portfolio-title">Engineering Portfolio</h2>
      <p class="lead">Selected projects with links to docs or code.</p>
      <div id="projects" class="project-list" role="list"></div>
    </section>

    <section id="blog" aria-labelledby="blog-title">
      <h2 id="blog-title">Blog</h2>
      <p class="lead">Short notes and write‑ups.</p>
      <div id="posts" class="entry-list" role="list"></div>
    </section>

    <section id="books" aria-labelledby="books-title">
      <h2 id="books-title">Book Reviews</h2>
      <p class="lead">Quick takes with a simple rating.</p>
      <div id="books-list" class="grid cards" role="list"></div>
    </section>

    <section id="photos" aria-labelledby="photos-title">
      <h2 id="photos-title">Travel Photos</h2>
      <p class="lead">Trips grouped with photos and quick notes. Expand to view each gallery.</p>
      <div id="trips" class="trip-list" role="list"></div>
    </section>
  </main>

  <footer>
    <div>© <span id="year"></span> <span id="owner">Anton Shoham</span>. • <a href="#portfolio">Portfolio</a> • <a href="#blog">Blog</a> • <a href="#books">Books</a> • <a href="#photos">Travel</a></div>
  </footer>

  <!-- Post / Lightbox Modal -->
  <div id="backdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div id="modal" class="modal" role="document" aria-labelledby="modal-title">
      <header>
        <h3 id="modal-title"></h3>
        <button class="close" id="modal-close" aria-label="Close">Close</button>
      </header>
      <div class="content" id="modal-content"></div>
    </div>
  </div>

  <!-- ===== Site config (edit email/resume path here) ===== -->
  <script id="site-config" type="application/json">
  { "owner": "Anton Shoham", "email": "you@example.com", "resume": "Anton_Shoham_Resume.pdf" }
  </script>

  <!-- ===== Inline content data (edit these to populate your site) ===== -->
  <script id="data-projects" type="application/json">
  [
    {
      "title": "Plasma Centrifuge (Marathon Fusion)",
      "summary": "Designed control electronics and software, safety interlocks, and DAQ for a plasma. Helped build and test hollow cathode plasma source.",
      "bullets": [
        "Helped design and machine Hollow Cathode plasma source",
        "Implemented state machine which controls: gas flow, magnetic field, plasma ignition and hollow cathode temperature",
        "Implemented monitoring and saving of pressure, temperature, and current data a .csv",
        "Implemented safety interlocks, including emergency stop button, relay status checks, and light and alarm indicators",
        "Mitigated EMI using fiber optics for E-Stop and relay status checks"
      ],
      "gallery": [
        
        {"src": "projects/marathonfusion/DAQ_Front.jpg", "caption": "Low voltage electronics"},
        {"src": "projects/marathonfusion/DAQ_back.jpg", "caption": "Low voltage electronics"},
        {"src": "projects/marathonfusion/gas_feed.jpg", "caption": "Gas feed system and electronics"},
        {"src": "projects/marathonfusion/Battery Cart State Machine.png", "caption": "Power electronics state machine"},
        {"src": "projects/marathonfusion/CHARYBDIS State Machine.png", "caption": "Software state machine"}
      ],
      "links": [
        {"label": "GitHub", "href": "https://github.com/Anton153"},
        {"label": "Report", "href": "#"}
      ],
      "tags": ["Plasma", "DAQ", "Controls"],
      "image": "projects/marathonfusion/DAQ_Front.jpg"
    },
    {
      "title": "Line‑Following Robot in Gazebo",
      "summary": "ROS Noetic simulation, camera‑based lane keeping with PID and imitation learning.",
      "details": "Implemented PID baseline and an imitation‑learning policy from recorded demonstrations. Built tooling to log frames + cmd_vel, trained a small CNN, and compared lap stability vs loss.",
      "bullets": [
        "ROS Noetic + Gazebo sim world",
        "Imitation learning baseline vs PID",
        "Tools for dataset logging & eval"
      ],
      "gallery": [
        {"src": "https://images.unsplash.com/photo-1518779578993-ec3579fee39f?w=1600&q=60", "alt": "Robot prototype", "caption": "Sim rig & camera"}
      ],
      "links": [
        {"label": "Code", "href": "https://github.com/Anton153"},
        {"label": "Write‑up", "href": "#"}
      ],
      "tags": ["ROS", "Gazebo", "Control"],
      "image": "https://images.unsplash.com/photo-1518779578993-ec3579fee39f?w=1200&q=60"
    },
    {
      "title": "UBC Orbit CubeSat — Firmware & Controls",
      "summary": "Firmware/controls work on a student satellite program; data acquisition and system integration.",
      "details": "Wrote firmware and test utilities for subsystem bring‑up, participated in hardware‑in-the-loop testing, and contributed to data handling + telemetry procedures.",
      "bullets": ["HAL drivers & test fixtures", "Hardware-in-the-loop testing", "Telemetry utilities"],
      "links": [
        {"label": "UBC Orbit", "href": "https://github.com/Anton153"}
      ],
      "tags": ["CubeSat", "Firmware", "Embedded"],
      "image": "https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=1200&q=60"
    },
    {
      "title": "High‑Temperature Thermal Cycler (MKS Instruments)",
      "summary": "20–800°C thermal system with closed‑loop control; modeling, control, and hardware bring‑up.",
      "details": "Developed ramp/soak profiles, tuned PID, and built a simple interface for logging and setpoint control. Verified thermal response with sensors and generated a BOM.",
      "bullets": ["PID tuning & profiles", "Sensor calibration", "BOM & build notes"],
      "links": [
        {"label": "Notes", "href": "#"}
      ],
      "tags": ["Thermal", "Embedded", "Control"],
      "image": "https://images.unsplash.com/photo-1559757175-08c8eeec75a3?w=1200&q=60"
    },
    {
      "title": "Plasma Centrifuge Contactor Panel",
      "summary": "High‑current distribution with relays and safety interlocks; schematic capture and wiring.",
      "details": "Designed wiring, interlocks, and contactor control for the test stand; documented harnessing and labeling for safe operation and maintenance.",
      "bullets": ["Contactor + relay logic", "Safety interlocks", "Harness labeling"],
      "links": [
        {"label": "Schematic", "href": "#"}
      ],
      "tags": ["Power", "Safety", "Schematics"],
      "image": "https://images.unsplash.com/photo-1518770660439-4636190af475?w=1200&q=60"
    },
    {
      "title": "Burger‑Building Robots (Mechanical Design)",
      "summary": "Two robots with claws, conveyor, and omni/mecanum drivetrains; designed in SolidWorks and fabricated via laser‑cutting/3D‑printing.",
      "details": "Led mechanical design, produced assemblies and drawings, and oversaw fabrication + testing. Explored claw kinematics and belt timing.",
      "bullets": ["SolidWorks assemblies", "Laser-cut + 3D-printed parts", "Omni/mecanum drivetrain"],
      "links": [
        {"label": "Gallery", "href": "#"}
      ],
      "tags": ["Mechanical", "Robotics", "SolidWorks"],
      "image": "https://images.unsplash.com/photo-1502877338535-766e1452684a?w=1200&q=60"
    }
  ]
  </script>

  <script id="data-posts" type="application/json">
  [
    {
      "title": "A very small note on anti‑alias filtering",
      "date": "2025-07-12",
      "tags": ["Measurement", "Signals"],
      "summary": "Rule of thumb: an RC just above your passband often wins in practice.",
      "image": "https://images.unsplash.com/photo-1546900703-cf06143d1239?w=1200&q=60",
      "content": "When sampling up to 50 kHz, a first‑order RC set slightly above the band of interest often beats \"infinite\" bandwidth probes in practice. You trade a bit of rise time for cleaner spectra and happier ADCs. Keep source impedance reasonable and watch the DAQ's input impedance.\n\nI like to start with fc ~1.2× fmax and iterate."
    },
    {
      "title": "Choosing flight connectors for small sats",
      "date": "2025-06-30",
      "tags": ["Connectors", "Aerospace"],
      "summary": "Short checklist for connector selection on student spacecraft.",
      "image": "https://images.unsplash.com/photo-1555617981-dac3880bde15?w=1200&q=60",
      "content": "Quick criteria: current density, derating, latching, keying, outgassing, EMC, and serviceability. Document backshells and strain relief early.\n\nPick families with solid crimp ecosystems and avoid rare contacts that are hard to source during integration."
    }
  ]
  </script>

  <script id="data-books" type="application/json">
  [
    {
      "title": "The Design of Everyday Things",
      "author": "Don Norman",
      "rating": 5,
      "blurb": "A timeless checklist for empathetic engineering."
    },
    {
      "title": "Structures: Or Why Things Don't Fall Down",
      "author": "J.E. Gordon",
      "rating": 4,
      "blurb": "Gentle, vivid intro to mechanics."
    }
  ]
  </script>

  <script id="data-trips" type="application/json">
  [
    {
      "title": "2024 Morocco Trip",
      "subtitle": "Spring 2024 • Morocco",
      "note": "From Marrakech souks to the Atlas foothills — lots of color and mint tea.",
      "cover": "https://images.unsplash.com/photo-1501785888041-af3ef285b470?w=1600&q=60",
      "photos": [
        { "src": "https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?w=1600&q=60", "alt": "Blue alley in Chefchaouen", "caption": "Chefchaouen blues" },
        { "src": "https://images.unsplash.com/photo-1519681393784-d120267933ba?w=1600&q=60", "alt": "Palm and desert", "caption": "Palm shadows" },
        { "src": "https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?w=1600&q=60", "alt": "Mountain road", "caption": "Atlas curves" }
      ]
    },
    {
      "title": "2023 New Zealand Road Trip",
      "subtitle": "Winter 2023 • South Island",
      "note": "Long drives, big skies, and a lot of flat whites.",
      "cover": "https://images.unsplash.com/photo-1500534314210-7d80a0586b16?w=1600&q=60",
      "photos": [
        { "src": "https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?w=1600&q=60", "alt": "Lake and mountains", "caption": "Mirror water" },
        { "src": "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?w=1600&q=60", "alt": "Sea cliffs", "caption": "Wild coast" },
        { "src": "https://images.unsplash.com/photo-1491553895911-0055eca6402d?w=1600&q=60", "alt": "City evening", "caption": "Evening lights" }
      ]
    }
  ]
  </script>

  <!-- ===== Minimal JS to render content & modals ===== -->
  <script>
    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    // Config
    const cfg = JSON.parse($('#site-config').textContent || '{}');

    const formatDate = iso => {
      try { return new Date(iso).toLocaleDateString(undefined, { year:'numeric', month:'short', day:'2-digit' }); } catch { return iso; }
    };

    const create = (tag, attrs={}, children=[]) => {
      const el = document.createElement(tag);
      for (const [k,v] of Object.entries(attrs)) {
        if (k === 'class') el.className = v;
        else if (k === 'html') el.innerHTML = v;
        else if (k.startsWith('on') && typeof v === 'function') el.addEventListener(k.substring(2), v);
        else el.setAttribute(k, v);
      }
      for (const child of [].concat(children)) if (child) el.append(child);
      return el;
    };

    const openModal = (title, contentEl, lightbox=false) => {
      $('#modal-title').textContent = title || '';
      const host = $('#modal-content');
      host.replaceChildren(contentEl);
      const m = $('#modal');
      m.classList.toggle('lightbox', !!lightbox);
      const bd = $('#backdrop');
      bd.style.display = 'flex';
      bd.setAttribute('aria-hidden', 'false');
    };
    const closeModal = () => {
      const bd = $('#backdrop');
      bd.style.display = 'none';
      bd.setAttribute('aria-hidden', 'true');
      $('#modal-content').replaceChildren();
    };
    $('#modal-close').addEventListener('click', closeModal);
    $('#backdrop').addEventListener('click', (e) => { if (e.target.id === 'backdrop') closeModal(); });
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

    // Apply config
    if (cfg.owner) { $('#brand').textContent = cfg.owner; $('#owner').textContent = cfg.owner; }
    if (cfg.email) { $('#contact-link').href = `mailto:${cfg.email}`; $('#email-btn').href = `mailto:${cfg.email}`; }
    if (cfg.resume) { $('#resume-btn').href = cfg.resume; }

    // Render Projects (full-width rows with Read more + bullets + gallery)
    const projects = JSON.parse($('#data-projects').textContent);
    const projHost = $('#projects');
    projects.forEach(p => {
      const article = create('article', { class:'project', role:'listitem' });

      const img = p.image ? create('img', { src: p.image, alt: p.title, loading:'lazy', onerror: (e)=>{ e.target.style.display='none'; } }) : null;
      if (img) article.append(create('div', {}, img));

      const title = create('h3', {}, p.title);
      const summary = create('p', { class:'meta' }, p.summary || '');

      // Build expanded area
      const expandedChildren = [];
      if (p.details) expandedChildren.push(create('p', {}, p.details));

      if (Array.isArray(p.bullets) && p.bullets.length) {
        const ul = create('ul', { class:'bullets' });
        p.bullets.forEach(b => ul.append(create('li', {}, b)));
        expandedChildren.push(ul);
      }

      if (Array.isArray(p.gallery) && p.gallery.length) {
        const grid = create('div', { class:'grid photos gallery' });
        p.gallery.forEach(ph => {
          const fig = create('figure', { class:'shot' });
          const im = create('img', { src: ph.src, alt: ph.alt || '', loading:'lazy' });
          im.onerror = () => { im.src = `https://via.placeholder.com/800x600?text=Photo`; };
          fig.append(im);
          if (ph.caption) fig.append(create('figcaption', { class:'cap' }, ph.caption));
          fig.addEventListener('click', () => {
          const figure = create('figure', { class:'lightbox-fig' });
          const big = create('img', { src: ph.src, alt: ph.alt||'', loading:'eager' });
          figure.append(big);
          if (ph.caption) figure.append(create('figcaption', {}, ph.caption));
          const wrap = create('div', { class:'content lightbox' }, figure);
          openModal('', wrap, true);
        });

          grid.append(fig);
        });
        expandedChildren.push(grid);
      }

      if (p.tags?.length) expandedChildren.push(create('div', { class:'tags' }, p.tags.map(t => create('span', { class:'tag' }, t))));
      if (p.links?.length) expandedChildren.push(create('div', { class:'actions' }, p.links.map(l => create('a', { href:l.href, class:'btn', target:'_blank', rel:'noopener' }, l.label))));

      const more = create('div', { class:'more' }, expandedChildren);

      const readBtn = create('button', { class:'btn readmore', 'aria-expanded':'false' }, 'Read more');
      readBtn.addEventListener('click', () => {
        const ex = article.classList.toggle('expanded');
        readBtn.textContent = ex ? 'Read less' : 'Read more';
        readBtn.setAttribute('aria-expanded', ex ? 'true' : 'false');
      });

      const right = create('div', {}, [
        title,
        summary,
        create('div', { class:'actions' }, [ readBtn ]),
        more
      ]);
      article.append(right);
      projHost.append(article);
    });

    // Render Posts as full-width entries with Read more
    const posts = JSON.parse($('#data-posts').textContent);
    const postHost = $('#posts');
    posts.forEach(post => {
      const article = create('article', { class:'entry', role:'listitem' });
      const img = post.image ? create('img', { src: post.image, alt: post.title, loading:'lazy', onerror: (e)=>{ e.target.style.display='none'; } }) : null;
      if (img) article.append(create('div', {}, img));
      const title = create('h3', {}, post.title);
      const meta = create('div', { class:'meta' }, `${formatDate(post.date)}${post.tags?.length? ' • ' + post.tags.join(', ') : ''}`);
      const summary = post.summary ? create('p', { class:'meta' }, post.summary) : null;
      const more = create('div', { class:'more' }, [
        create('div', { class:'content-body', html: `<p>${(post.content||'').replace(/\n/g,'</p><p>')}</p>` })
      ]);
      const readBtn = create('button', { class:'btn readmore', 'aria-expanded':'false' }, 'Read more');
      readBtn.addEventListener('click', () => {
        const ex = article.classList.toggle('expanded');
        readBtn.textContent = ex ? 'Read less' : 'Read more';
        readBtn.setAttribute('aria-expanded', ex ? 'true' : 'false');
      });
      const right = create('div', {}, [ title, meta, summary, create('div', { class:'actions' }, [ readBtn ]), more ]);
      article.append(right);
      postHost.append(article);
    });

    // Render Books (cards with optional Read more)
    const books = JSON.parse($('#data-books').textContent);
    const bookHost = $('#books-list');
    books.forEach(b => {
      const card = create('article', { class:'card', role:'listitem' });
      card.append(
        create('h3', {}, b.title),
        create('div', { class:'meta' }, `${b.author || ''}`),
        create('div', { class:'meta' }, `Rating: ${'★'.repeat(b.rating||0)}${'☆'.repeat(5-(b.rating||0))}`),
        create('p', {}, b.blurb||'')
      );
      if (b.review) {
        const more = create('div', { class:'more' }, [ create('div', { class:'content-body', html: `<p>${(b.review||'').replace(/\n/g,'</p><p>')}</p>` }) ]);
        const readBtn = create('button', { class:'btn' }, 'Read more');
        readBtn.addEventListener('click', () => {
          const ex = card.classList.toggle('expanded');
          readBtn.textContent = ex ? 'Read less' : 'Read more';
        });
        card.append(create('div', { class:'row' }, [readBtn]), more);
      }
      bookHost.append(card);
    });

    // Render Trips + Lightbox (grouped galleries with toggle)
    const trips = JSON.parse($('#data-trips').textContent);
    const tripsHost = $('#trips');
    trips.forEach(tr => {
      const article = create('article', { class:'trip', role:'listitem' });
      const cover = tr.cover || (tr.photos && tr.photos[0]?.src);
      const img = cover ? create('img', { src: cover, alt: tr.title, loading:'lazy', onerror:(e)=>{ e.target.style.display='none'; } }) : null;
      if (img) article.append(create('div', {}, img));
      const title = create('h3', {}, tr.title);
      const meta = tr.subtitle ? create('div', { class:'meta' }, tr.subtitle) : null;
      const note = tr.note ? create('p', { class:'meta' }, tr.note) : null;

      const gallery = create('div', { class:'grid photos' });
      (tr.photos||[]).forEach(ph => {
        const thumb = create('div', { class:'photo' });
        const im = create('img', { src: ph.src, alt: ph.alt||'', loading:'lazy' });
        im.onerror = () => { im.src = `https://via.placeholder.com/800x600?text=Photo`; };
        thumb.append(im);
        thumb.addEventListener('click', () => {
        const figure = create('figure', { class:'lightbox-fig' });
        const big = create('img', { src: ph.src, alt: ph.alt||'', loading:'eager' });
        figure.append(big);
        if (ph.caption) figure.append(create('figcaption', {}, ph.caption));
        const wrap = create('div', { class:'content lightbox' }, figure);
        openModal('', wrap, true);
      });

        gallery.append(thumb);
      });

      const more = create('div', { class:'more' }, [ gallery ]);
      const readBtn = create('button', { class:'btn readmore', 'aria-expanded':'false' }, 'View photos');
      readBtn.addEventListener('click', () => {
        const ex = article.classList.toggle('expanded');
        readBtn.textContent = ex ? 'Hide photos' : 'View photos';
        readBtn.setAttribute('aria-expanded', ex ? 'true' : 'false');
      });

      const right = create('div', {}, [ title, meta, note, create('div', { class:'actions' }, [ readBtn ]), more ]);
      article.append(right);
      tripsHost.append(article);
    });

    // Year
    $('#year').textContent = new Date().getFullYear();
    $('#year').textContent = new Date().getFullYear();

    // Smooth scroll for nav links
    $$('.links a').forEach(a => a.addEventListener('click', (e) => {
      const id = a.getAttribute('href');
      if (id && id.startsWith('#')) {
        e.preventDefault();
        document.querySelector(id)?.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }));
  </script>

  <noscript>
    <div style="max-width:1000px;margin:24px auto;padding:12px 16px;border:1px solid #e5e7eb;border-radius:12px;color:#6b7280;">
      This site is fully static. Enable JavaScript to render portfolio items, posts, books, and photos.
    </div>
  </noscript>
</body>
</html>
